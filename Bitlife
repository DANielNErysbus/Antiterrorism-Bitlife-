import random
from dataclasses import dataclass, field
from typing import List, Dict
import time

@dataclass
class Terrorist:
    name: str
    age: int
    role: str
    loyalty: int
    skills: List[str]
    location: str
    is_alive: bool = True
    traits: List[str] = field(default_factory=list)
    wanted_level: int = 0
    relations: List[str] = field(default_factory=list)

@dataclass
class TerrorGroup:
    name: str
    leaders: List[str]
    structure: Dict[str, int]
    ideology: str
    territory: str
    strength: int = 50

@dataclass
class Player:
    name: str
    agency: str
    rank: str = "–°—Ç–∞–∂—ë—Ä"
    reputation: int = 50
    completed_missions: int = 0
    skills: Dict[str, int] = field(default_factory=lambda: {
        "–°—Ç—Ä–µ–ª—å–±–∞": 30,
        "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞": 40,
        "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã": 20,
        "–•–∞–∫–µ—Ä—Å—Ç–≤–æ": 10
    })

def generate_terrorist(group_name: str) -> Terrorist:
    name = random.choice([
        "–ê—Ö–º–∞–¥ –ê–ª—å-–ë–∞–≥–¥–∞–¥–∏",
        "–ú—É—Ö–∞–º–º–∞–¥ –ê–ª—å-–•–∞–ª–∏–¥",
        "–ò—Å–º–∞–∏–ª –ì—É—Ä–±–∞–Ω–∏",
        "–ó–∏—è –£—Ä-–†–∞—Ö–º–∞–Ω"
    ])
    age = random.randint(18, 55)
    role = random.choice(["–ë–æ–µ–≤–∏–∫", "–°–Ω–∞–π–ø–µ—Ä", "–ü–æ–¥—Ä—ã–≤–Ω–∏–∫", "–í–µ—Ä–±–æ–≤—â–∏–∫", "–§–∏–Ω–∞–Ω—Å–∏—Å—Ç"])

    return Terrorist(
        name=name,
        age=age,
        role=role,
        loyalty=random.randint(30, 100),
        skills=get_skills_by_role(role),
        location=group_name,
        traits=get_random_traits(),
        wanted_level=random.randint(0, 5)
    )

def generate_terror_group(name: str) -> TerrorGroup:
    leaders = [f"–õ–∏–¥–µ—Ä {random.randint(1, 100)}" for _ in range(random.randint(1, 3))]

    return TerrorGroup(
        name=name,
        leaders=leaders,
        structure={
            "–ë–æ–µ–≤–∏–∫–∏": random.randint(30, 200),
            "–°–Ω–∞–π–ø–µ—Ä—ã": random.randint(5, 20),
            "–ü–æ–¥—Ä—ã–≤–Ω–∏–∫–∏": random.randint(10, 30),
            "–§–∏–Ω–∞–Ω—Å–∏—Å—Ç—ã": random.randint(3, 10)
        },
        ideology=random.choice(["–ò—Å–ª–∞–º–∏—Å—Ç—Å–∫–∏–π", "–°–µ–ø–∞—Ä–∞—Ç–∏—Å—Ç—Å–∫–∏–π", "–ê–Ω–∞—Ä—Ö–∏—Å—Ç—Å–∫–∏–π"]),
        territory=random.choice(["–ö–∞—à–º–∏—Ä", "–í–∞–∑–∏—Ä–∏—Å—Ç–∞–Ω", "–°–æ–º–∞–ª–∏", "–ô–µ–º–µ–Ω"]),
        strength=random.randint(30, 80)
    )

def start_game():
    print("=== COUNTER-TERROR BITLIFE ===")
    print("–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–µ–≥–æ –∞–≥–µ–Ω—Ç–∞:")

    player = Player(
        name=input("–ò–º—è –∞–≥–µ–Ω—Ç–∞: "),
        agency=select_agency()
    )

    groups = [
        generate_terror_group("–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ö–∞—à–º–∏—Ä–∞"),
        generate_terror_group("–ò—Å–ª–∞–º—Å–∫–∏–π –î–∂–∏—Ö–∞–¥"),
        generate_terror_group("–ê–ª—å-–£–º–º–∞")
    ]

    terrorists = [generate_terrorist(group.name) for group in groups for _ in range(10)]

    year = 2023
    while year < 2033 and player.reputation < 100:
        print(f"\n=== {year} –≥–æ–¥ ===")
        print(f"{player.rank} {player.name} | –†–µ–ø—É—Ç–∞—Ü–∏—è: {player.reputation}")

        handle_random_event(player, groups, terrorists)

        check_promotion(player)

        year += 1
        time.sleep(1)

    print(f"\n–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í–∞—à —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–Ω–≥: {player.rank}")

def select_agency():
    agencies = {
        "1": {"name": "FSB", "bonus": "–°–∏–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏"},
        "2": {"name": "CIA", "bonus": "–ö–∏–±–µ—Ä—Ä–∞–∑–≤–µ–¥–∫–∞"},
        "3": {"name": "MI6", "bonus": "–ê–≥–µ–Ω—Ç—É—Ä–Ω–∞—è —Å–µ—Ç—å"}
    }

    print("\n–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü—Å–ª—É–∂–±—É:")
    for num, data in agencies.items():
        print(f"{num}. {data['name']} ({data['bonus']})")

    while True:
        choice = input("> ")
        if choice in agencies:
            return agencies[choice]["name"]
        print("–ù–µ–≤–µ—Ä–Ω—ã–π –≤–≤–æ–¥!")

def handle_random_event(player: Player, groups: List[TerrorGroup], terrorists: List[Terrorist]):
    events = [
        {"type": "mission", "weight": 70},
        {"type": "organization_activity", "weight": 20},
        {"type": "training", "weight": 10}
    ]

    event = random.choices(
        [e["type"] for e in events],
        weights=[e["weight"] for e in events]
    )[0]

    if event == "mission":
        start_mission(player, terrorists)
    elif event == "organization_activity":
        org_activity(groups)
    else:
        training_event(player)

def start_mission(player: Player, terrorists: List[Terrorist]):
    target = random.choice([t for t in terrorists if t.is_alive])

    print(f"\nüö® –ú–ò–°–°–ò–Ø: {target.role.upper()} {target.name}")
    print(f"–õ–æ–∫–∞—Ü–∏—è: {target.location}")
    print(f"–ü—Ä–∏–º–µ—Ç—ã: {', '.join(target.traits) if target.traits else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã'}")
    print(f"–£—Ä–æ–≤–µ–Ω—å —É–≥—Ä–æ–∑—ã: {'‚òÖ' * target.wanted_level}")

    print("\n–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥:")
    print("1. –°–∏–ª–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è (–°—Ç—Ä–µ–ª—å–±–∞)")
    print("2. –í–µ—Ä–±–æ–≤–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∞ (–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã)")
    print("3. –ö–∏–±–µ—Ä—Å–ª–µ–∂–∫–∞ (–•–∞–∫–µ—Ä—Å—Ç–≤–æ)")

    choice = input("> ")
    skill = {"1": "–°—Ç—Ä–µ–ª—å–±–∞", "2": "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã", "3": "–•–∞–∫–µ—Ä—Å—Ç–≤–æ"}.get(choice, "")

    if skill and player.skills[skill] > random.randint(0, 100):
        print(f"‚úÖ –£—Å–ø–µ—Ö! {target.name} –ª–∏–∫–≤–∏–¥–∏—Ä–æ–≤–∞–Ω.")
        target.is_alive = False
        player.reputation += 10
        player.completed_missions += 1
    else:
        print("‚ùå –ü—Ä–æ–≤–∞–ª! –¶–µ–ª—å –∏–∑–±–µ–∂–∞–ª–∞ –∑–∞—Ö–≤–∞—Ç–∞.")

if __name__ == "__main__":
    start_game()
